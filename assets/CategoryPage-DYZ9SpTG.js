import{j as e,r as p,E as P,l as E,I as $,J as A,S as f}from"./index-DyDWDGaa.js";import L from"./NotFoundPage-32An-lBM.js";const B=()=>e.jsx("div",{className:"wrap",children:e.jsxs("div",{className:"flex p-4 gap-3 animate-pulse",children:[e.jsx("div",{className:"flex flex-col bg-white rounded-lg w-[250px] p-2",children:[...Array(3)].map(s=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"bg-gray-200 w-40 h-[18px] rounded mt-[8px]"}),[...Array(5)].map(r=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-gray-200 h-[12px] rounded mt-[12px]"})}))]})}))}),e.jsxs("div",{className:" grow p-4 bg-white rounded-lg",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"bg-gray-200 w-[150px] h-[12px] rounded mb-[8px]"}),e.jsx("div",{className:"bg-gray-200 w-[150px] h-[12px] rounded mb-[8px]"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-3 mt-3",children:[...Array(7)].map(s=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"bg-gray-200 w-[150px] h-[150px] rounded-lg mb-[8px]"}),e.jsxs("div",{className:"wrapper",children:[e.jsx("div",{className:"bg-gray-200 w-[150px] h-3 rounded mb-2"}),e.jsx("div",{className:"bg-gray-200 w-[100px] h-3 rounded mb-2"}),e.jsx("div",{className:"bg-gray-200 w-[150px] h-3 rounded"})]})]})}))})]})]})}),I=()=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/60 z-10",children:e.jsx("div",{className:"w-8 h-8 border-4 border-gray-300 border-t-[#C92127] rounded-full animate-spin"})}),v=({items:s,threshold:r=5,renderItem:t})=>{const[n,c]=p.useState(!1),i=n?s:s.slice(0,r);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col space-y-2 pl-3",children:i.map((o,d)=>t(o,d))}),s.length>r&&e.jsx("div",{className:"pl-3 mt-2",children:e.jsx("button",{onClick:()=>c(!n),className:"text-sm font-medium cursor-pointer",children:n?"Thu gọn ^":"Xem thêm v"})})]})},R=({data:s,onSelect:r})=>e.jsxs("div",{className:"main-category",children:[e.jsx("h3",{className:"text-xl font-semibold mb-3 text-gray-800",children:"Danh mục"}),e.jsxs("div",{className:"ml-2 space-y-2",children:[s.parent_categories?.map(t=>{const n=s.category.id===t.id;return e.jsx("div",{className:`text-sm transition-colors ${n?"font-medium text-[#C92127]":"text-gray-500 hover:text-[#C92127] cursor-pointer"}`,onClick:()=>!n&&r("category",t.id),children:t.name},t.id)}),e.jsx(v,{items:s.children_categories||[],threshold:6,renderItem:(t,n)=>e.jsxs("div",{className:"text-sm text-[#666666] hover:text-[#C92127] cursor-pointer transition-colors",onClick:()=>r("category",t.id),children:[t.name," (",t.count,")"]},n)})]})]}),N=({label:s,code:r,items:t,selectedFilters:n,onSelect:c,onSelectPrice:i})=>e.jsxs("div",{className:"ml-4 mb-4",children:[e.jsx("h4",{className:"font-medium mb-2 text-gray-700 text-sm",children:s}),e.jsx(v,{items:t,threshold:5,renderItem:(o,d)=>{const l=r?n[r]===o.param:n.price_range.min===o.from&&n.price_range.max===o.to;return e.jsxs("label",{className:"flex items-center gap-2 text-sm text-[#666666] cursor-pointer hover:text-[#C92127]",children:[e.jsx("input",{type:"checkbox",className:"accent-[#C92127] w-4 h-4",checked:l,onChange:()=>r&&c?c(r,o.param):i?.({min:o.from,max:o.to})}),e.jsx("span",{children:o.label})]},d)}})]}),G=[{id:1,label:"0đ - 150,000đ",from:0,to:15e4},{id:2,label:"150,000đ - 300,000đ",from:15e4,to:3e5},{id:3,label:"300,000đ - 500,000đ",from:3e5,to:5e5},{id:4,label:"500,000đ - 700,000đ",from:5e5,to:7e5},{id:5,label:"700,000đ - trở lên",from:7e5,to:9999999}],O=({data:s,selectedFilters:r,onSelect:t,onSelectPrice:n})=>e.jsxs("aside",{className:"sticky top-[133px] h-fit min-w-[280px] p-3 bg-white rounded-lg space-y-6 shadow-sm",children:[e.jsx(R,{data:s,onSelect:t}),e.jsxs("div",{className:"filter-category",children:[e.jsx("h3",{className:"text-xl font-semibold mb-3 text-gray-800",children:"Bộ lọc tìm kiếm"}),e.jsx(N,{label:"Giá",items:G,selectedFilters:r,onSelectPrice:n}),s.attributes?.map(c=>e.jsx(N,{label:c.label,code:c.code,items:c.options,selectedFilters:r,onSelect:t},c.id))]})]}),U=({bannerImages:s=[]})=>s.length?e.jsx("div",{className:"w-full mb-4",children:e.jsx("div",{className:`grid ${s.length>1?"grid-cols-2 gap-3":"grid-cols-1"}`,children:s.map((r,t)=>e.jsx("img",{src:r,alt:`Banner ${t+1}`,className:"w-full rounded-lg shadow-sm object-cover"},t))})}):null,D=({data:s,selectedSort:r,onSortChange:t})=>e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Sắp xếp theo:"}),e.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-700 cursor-pointer outline-none",value:r,onChange:n=>t(n.target.value),children:[e.jsx("option",{value:"best-selling",children:"Bán chạy"}),e.jsx("option",{value:"featured",children:"Nổi bật"}),e.jsx("option",{value:"newest",children:"Mới nhất"})]}),e.jsxs("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm text-gray-700 cursor-pointer outline-none",defaultValue:"",onChange:n=>t(n.target.value),children:[e.jsx("option",{value:"price-asc",children:"Giá tăng dần"}),e.jsx("option",{value:"price-desc",children:"Giá giảm dần"})]})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.category.name," — ",s.children_categories?.length||0," danh mục con"]})]}),T=({currentPage:s,totalPages:r,onPageChange:t,numberPage:n=5})=>{const c=Math.max(3,Math.min(n,7)),i=Math.min(Math.max(1,s),r||1),o=p.useMemo(()=>{if(r<=0)return[];const l=[],b=Math.floor(c/2);let x=Math.max(1,i-b),h=Math.min(r,x+c-1);h-x<c-1&&(x=Math.max(1,h-c+1));for(let j=x;j<=h;j++)l.push(j);return l},[i,r,c]),d=l=>{l>=1&&l<=r&&l!==i&&t(l)};return r<=1?null:e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-10 select-none",children:[e.jsx("button",{type:"button",onClick:()=>d(i-1),disabled:i<=1,className:`px-3 py-1 border rounded-lg text-sm font-medium transition-colors ${i<=1?"text-gray-400 border-gray-200":"text-gray-700 border-gray-300 hover:bg-gray-100 cursor-pointer"}`,children:"←"}),o[0]>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>d(1),className:`px-3 py-1 border rounded-lg text-sm font-medium cursor-pointer transition-colors ${i===1?"bg-[#C92127] text-white border-[#C92127]":"text-gray-700 border-gray-300 hover:bg-gray-100"}`,children:"1"}),o[0]>2&&e.jsx("span",{className:"text-gray-700 text-lg font-medium px-2",children:"..."})]}),o.map(l=>e.jsx("button",{type:"button",onClick:()=>d(l),className:`px-3 py-1 border rounded-lg text-sm font-medium cursor-pointer  ${l===i?"bg-[#C92127] text-white border-[#C92127]":"text-gray-700 border-gray-300 hover:bg-gray-100"}`,children:l},l)),o[o.length-1]<r&&e.jsxs(e.Fragment,{children:[o[o.length-1]<r-1&&e.jsx("span",{className:"text-gray-700 text-lg font-medium px-2",children:"..."}),e.jsx("button",{type:"button",onClick:()=>d(r),className:`px-3 py-1 border rounded-lg text-sm font-medium cursor-pointer transition-colors ${i===r?"bg-[#C92127] text-white border-[#C92127]":"text-gray-700 border-gray-300 hover:bg-gray-100"}`,children:r})]}),e.jsx("button",{type:"button",onClick:()=>d(i+1),disabled:i>=r,className:`px-3 py-1 border rounded-lg text-sm font-medium cursor-pointer  transition-colors ${i>=r?"text-gray-400 border-gray-200":"text-gray-700 border-gray-300 hover:bg-gray-100"}`,children:"→"})]})},V=({data:s,page:r,onPageChange:t})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-1",children:s.product_list?.length?s.product_list.map(n=>e.jsx(P,{product:n},n.id)):e.jsx("div",{className:"col-span-4 text-center text-gray-500 py-8",children:"Không có sản phẩm trong danh mục này."})}),s?.noofpages>1&&e.jsx(T,{currentPage:r,totalPages:s.noofpages,onPageChange:t})]}),J=()=>{const s=E(),[r,t]=$(),{category_id:n}=s.state||{},c=a=>{const m={category:a.get("category")||"",price_range:{min:Number(a.get("price_min"))||0,max:Number(a.get("price_max"))||999999999}};return a.forEach((u,g)=>{["category","price_min","price_max","sort","page"].includes(g)||(m[g]=u)}),m},[i,o]=p.useState(()=>c(r)),[d,l]=p.useState(r.get("sort")||"best-selling"),[b,x]=p.useState(Number(r.get("page"))||1),{data:h,isLoading:j,isFetching:C,isError:w}=A({page:b,sort:d,filters:i},{skip:!i.category}),_=(a,m,u)=>{const g=new URLSearchParams;a.category&&g.set("category",a.category),a.price_range.min>0&&g.set("price_min",a.price_range.min.toString()),a.price_range.max<999999999&&g.set("price_max",a.price_range.max.toString()),Object.keys(a).forEach(y=>{!["category","price_range"].includes(y)&&a[y]&&g.set(y,a[y])}),m&&m!=="best-selling"&&g.set("sort",m),u>1&&g.set("page",u.toString()),t(g)},S=(a,m)=>{o(u=>({...u,[a]:u[a]===m?"":m})),x(1)},F=a=>{o(m=>({...m,price_range:m.price_range.min===a.min&&m.price_range.max===a.max?{min:0,max:999999999}:a})),x(1)},k=a=>{l(a),x(1)},M=a=>x(a);return p.useEffect(()=>{n&&(o(a=>({...a,category:n})),x(1))},[n]),p.useEffect(()=>{_(i,d,b)},[i,d,b]),p.useEffect(()=>{o(c(r)),l(r.get("sort")||"best-selling"),x(Number(r.get("page"))||1)},[r]),j?e.jsx(f,{bgColor:"none",children:e.jsx(B,{})}):h?.status===0||!h?.category||w?e.jsx(L,{}):e.jsxs(f,{bgColor:"none",children:[C&&e.jsx(I,{}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx(O,{data:h,selectedFilters:i,onSelect:S,onSelectPrice:F}),e.jsxs("main",{className:"grow p-4 bg-white rounded-lg shadow-sm h-fit",children:[e.jsx(U,{}),e.jsx(D,{data:h,selectedSort:d,onSortChange:k}),e.jsx(V,{data:h,page:b,onPageChange:M})]})]})]})};export{J as default};
